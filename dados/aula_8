library(dplyr)
library(tidyr)
library(rlang)
library(readxl)
library(stringr)
library(ggplot2)
library(lubridate)

celular_total <- read_excel('data/celular_total.xlsx')
cres_populacional <- read_excel('data/crescimento_populacional.xlsx')
exp_tecnologica <- read_excel('data/exportacao_tecnologica.xlsx')
horas_trab <- read_excel('data/horas_trab_por_semana.xlsx')
industria <- read_excel('data/Industry (p of GDP).xlsx')
pop_urbana <- read_excel('data/porcentagem_pop_urbana.xlsx')

lista_bases <- list(
  celular_total,
  cres_populacional,
  exp_tecnologica,
  horas_trab,
  industria,
  pop_urbana
)

# renomeando a primeira variÃ¡vel 
for(i in 1:length(lista_bases)) {
  names(lista_bases[[i]])[1] <- 'paises'
}

lista_bases[[1]] %>% head()

class(lista_bases[[1]])

######

tab <- left_join(lista_base[[2]], lista_bases[[6]])
tab <- left_join(tab, lista_bases[[1]])
tab <- left_join(tab, lista_bases[[5]])
tab <- left_join(tab, lista_bases[[3]])
tab <- left_join(tab, lista_bases[[4]])

####

quatro_regioes <- tab %>% 
  group_by(ano, four_regions) %>% 
  summarise(cresc_populacional = mean(cresc_populacional, na.rm = TRUE),
            pop_urbana = mean(pop_urbana, na.rm = TRUE),
            celular_total = mean(celular_total, na.rm = TRUE),
            industria = mean(industria, na.rm = TRUE),
            exp_tecnologica = mean(exp_tecnologica, na.rm = TRUE),
            horas_trab = mean(horas_trab, na.rm = TRUE))

head(quatro_regioes)

media_cresc_populacional <- quatro_regioes$cresc_populacional %>% 
  mean(na.rm = TRUE) %>% 
  round(2)

ggplot(data = quatro_regioes,
       aes(x = ano, y = cresc_populacional, color = four_regions))+
  geom_line(size = 1)


